# 6. 메모리와 캐시 메모리

- 휘발성 저장 장치
- 비휘발성 저장 장치
- DRAM , SRAM , SDRAM, DDR SDRAM

## 6-1 RAM 의 특징과 종류

### RAM
- 실행할 프로그램의 명령어와 데이터가 저장
  - 휘발성 저장 장치
    - RAM
    - 전원 끄면 날아감
  - 비휘발성 저장 장치
    - HD, SSD, CD-ROM
    - 보조기억장치
    - CPU 는 보조기억장치에 접근 못함

- 일반적으로 보조기억장치에는 '저장할 대상' 주기억 장치에는 '실행할 대상' 을 저장한다

### RAM 용량과 성능

- RAM 용량이 작으면 보조기억장치를 들락날락 해야함
- RAM 용량이 크다면 RAM 안에 데이터를 저장해서 보조기억장치를 들릴필요 없음 -> 빠름

- 보조기억장치: 책장, RAM: 책상 
- 책상이 엄청 커버리면 그냥 책상에다가 다 두고 읽으면 된다
- 하지만 RAM이 무분별하게 크다고해서 성능이 비례하게 개선되지는 않음

### RAM 의 종류
- DRAM (dynamic RAM)
  - 시간이 지나면 점차 사라짐
  - 소멸을 막기위해 재활성화 해야함
  - 일반적으로 사용하는 RAM 이 DRAM 임
    - 저렴, 집적도 높음, 소비전력 낮음

- SRAM (Static)
  - 시간 지나도 데이터 유실 없음
  - DRAM 보다 빠름
  - 집적도 낮음, 전력 큼, 가격 비쌈
  - 대용량으로 만들어질 필요는 없지만 속도가 빨라야 하는 저장장치 에서 이용
  - 캐시 메모리


- SDRAM (Synchronous Dynamic RAM)
  - 발전된 형태의 DRAM
  - 클럭신호와 동기화 -> clock 신호에 맞춰 CPU 정보를 주고 받을 수 있음

- DDR SDRAM (Double Data Rate SDRAM)
  - 대역폭을 넓혀 속도를 빠르게 만든 SDRAM
  - SDRAM 보다 두배 정도 빠름
  - DDR2 SDRAM = DDR SDRAM*2

## 6-2 메모리의 주소 공간
- 물리 주소
- 논리 주소
- MMU
- 베이스 레지스터
- 한계 레지스터

### 물리 주소 논리 주소
- 물리 주소 : 메모리 하드웨어가 사용하는 주소
- 논리 주소 : CPU 와 실행중인 프로그램이 사용하는 주소
  - 프로그램 마다 같은 논리 주소 얼마든지 있을 수 있음
  - 실행중인 프로그램 에게 각각 부여된 0번지부터 시작하는 주소
  - 프로그램들의 물리주소를 알 필요 없음 (언제든지 사라질 수 있다)

### MMU
- cpu와 메모리가 상호작용하려면 물리주소와 논리주소의 변환이 필요함
- 주소 버스 사이에 위치한 MMU (메모리 관리 장치) 에서 수행
- 논리 주소 + 베이스 레지스터 값 = 물리 주소
- 베이스 레지스터 는 물리 주소를 저장/ 논리 주소는 프로그램의 시작점으로 부터 이격거리 


### 메모리 보호 기법

- 한계 레지스터
  - 논리주소 범위 벗어나는 명령어 실행 방지
  - 범위 벗어날 경우 인터럽트 발생
  
## 6-3 캐시 메모리
- 저장장치 계층 구조
- 캐시 메모리
- 캐시 적중률
- 참조 지역성

### 저장장치 계층 구조

- 빠른 저장 장치와 용량이 큰 저장장치는 양립 어려움
  - cpu 와가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느림
  - 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비쌈

- CPU에 얼마나 가까운가?
  - 저장 장치 계층 구조


![img src](https://user-images.githubusercontent.com/49462767/225005123-9b041d53-4673-4d4e-9a4b-1813c64bd7e0.png)


### 캐시 메모리

- SRAM
- 레지스터보다 용량이 크고 메모리보다 빠름
- 메모리에서 CPU 가 사용할 일부 데이터를 미리 캐시 메모리로 가지고 와서 활용
- cpu 연산 속도와 메모리 접근 속도의 차이를 줄이기 위한 저장 장치


- L3 (가장 느리고 대용량), L2, L1 (가장 빠르고 적은 용량)
- L1 I / L1D 로 분리하여 명령어 저장/ 데이터 저장 분리하는 경우도 있음 (분리형 캐시)


### 참조 지역성

- 캐시 메모리는 메모리보다 용량 작음
- 캐시 메모리는 CPU가 사용할 법한 대상을 '예측'하여 저장
- 캐시 메모리의 예측이 맞으면 '캐시 히트' 틀리면 '캐시 미스'
- 캐시 히트의 비율 = 캐시 적중률 (cache hit ratio)
- 캐시 메모리가 메모리로부터 가져올 데이터를 결정하는 원칙
  - '참조 지역성의 원리' (locality of reference)
  - cpu는 최근에 접근했던 메모리 공간에 다시 접근 하려는 경향이 있음
    - 변수에 저장된 값은 한번만 사용되는게 아닌 반복적으로 사용됨
  - cpu는 접근한 메모리 공간 근처를 접근 하려는 경향
    - 하나의 프로그램 내에서도 관련성 있는 데이터들은 모여서 저장됨
    - "공간 지역성"




