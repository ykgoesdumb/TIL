# 15. 파일 시스템
## 15-1 파일과 디렉터리

- 파일
  - SSD 와 같은 보조기억장치에 저장된 관련정보의 집합
  - 부가정보 (파일 속성)
    - attribute
    - metadata

### 파일 속성

- 유형, 크기 ,보호(rwx 유저별 권한), 생성 날짜, 마지막 접근 날짜, 마지막 수정 날짜, 생성자, 소유자, 위치


### 디렉토리
- 윈도우 운영체제에선 '폴더' 라고 부름
- 최상위 디렉토리 는 '루트 디렉토리' '/' 로 표현
  - 윈도우에선 디렉터리 구분자로 '₩'를 쓴다
  - 맥과 리눅스에선 '/'
- 디렉토리도 파일로 간주
  - 해당 디렉터리에 담겨있는 대상과 관련된 정보를 담고 있음
  - 테이블 형태로 구성


### 절대 디렉토리
- 절대 디렉토리는 루트 디렉터리부터 시작하는 경로

### 상대 디렉토리
- 상대 디렉토리는  현재 디렉토리부터 시작하는 경로
  - 아래 두기호를 통해 상대 디렉토리를 나타낸다.
  - 현재 디렉토리 (.)
  - 부모 디렉토리 (..)

## 15-2 파일 시스템

> 파일 시스템은 파일과 디렉토리를 일목요연하게 저장하고 접근 하게 하는 운영체제 내부 프로그램

- 우리는 갓 생산된 SSD 혹은 HDD 를 사용할 수 없음
  - 파티셔닝과 포맷작업을 거쳐야하기 때문
  - 파티셔닝
    - 큰 저장장치를 하나이상의 논리적인 단위로 구획
    - 하나의 단위 = 파티션
    - 윈도우의 '하드 디스크 파티션 만들기 및 포맷'
  - 포맷팅
    - 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할지 결정
    - 새로운 데이터를 쓸 준비
    - 저수준 포매팅
      - 저장장치 생성할때 공장에서 수행되는 물리적인 포맷팅
    - 논리적 포매팅
      - 파일 시스템을 생성하는 포맷팅 (위에서 나온설명은 논리적 포매팅임)
<br>

- 파일 시스템 다양하고 파티션 별로 다른 파일 시스템 사용 가능
- 파티셔닝과 포매팅 동시에 진행되는 경우 많음
- 포매팅 이후에 판매되는 경우 많음


### 파일 할당 방법
- 운영체제는 파일과 디렉토리를 block 단위로 읽고 씀
- sector 가 최소 단위지만 너무 많고 크기가 작다
- 파일을 보조기억장치에 할당하는 방법
  - 연속 할당 (continguous allocation)
    - 외부 단편화
  - 불연속 할당
    - 연결 할당 (linked allocation)
      - 각 블록이 다음 블록을 가리키는 형태 (블록의 주소를 저장한다 (pointer))
      - 연결 리스트로 관리
      - 연결 할당의 단점
        - 반드시 첫번째 블록부터 하나씩 차례대로 읽어야 함
        - 임의접근(random access)속도 매우 느림 / i 번째 블록에 접근하려면 처음부터 순서대로 접근해야함
        - 하드웨어 고장시 해당 블록 이후 블록 접근 불가
    - 색인 할당 (index allocation)
      - 모든 블록 주소를 index block 에 모아 관리
      - 색인 할당 파일시스템에서는 모든 파일에 색인 블록 주소 명시


### 파일 시스템 

- FAT 파일 시스템 (file allocation table)
  - USB 메모리, SD 카드에서 사용
  - 연결 할당 단점 보완
  - 각 블록에 포함된 다음 블록의 주소들을 한데 모아 테이블 형태로 관리
  - FAT 는 하드디스크 파티션이  시작부분에 있지만 실행하는 도중 FAT이 메모리에 캐시될 수 있음 -> 연결 할당보다 훨씬 빠름

![img src](https://user-images.githubusercontent.com/49462767/226167388-3be3d4c2-4b6c-4321-bd61-16d3cd0a4481.png)



- Unix 파일 시스템
  - 색인 할당 기반
  - i-node (index node)
    - 자세한건 LINUX/i-node 참조
    - 블록 주소중 열두개에는 직접 블록 주소 저장
    - 충분치 않다면 열세번째에 단일 간접 블록 주소 저장 
      - (single indirect block) 이란 블록 주소가 저장된 블록  
    - 충분치 않다면 열네번째에 이중 간접 블록 주소 저장 (double indirect block)
    - 충분치 않다면 열다섯번째에 삼중 간접 블록 주소 저장 (triple indirect block)
      - 이 단계에서 웬만한 크기의 파일 모두 표현 가능


- 그외의 파일시스템
  - NTFS (윈도우)
  - EXT (리눅스)

- 저널링 파일시스템
  - 크래시 발생  후 다시 부팅을 할 경우  파일시스템 전체를 검사하는 것이 아닌 로그만 검사해도 됨
  - 작업 직전 파티션의 로그 영역에 변경사항에대한 로그 남김
  - 로그 남긴 후 작업 수행
  - 작업이 끝나면 로그 삭제
- 현대 파일 시스템은 이러한 저널링 기능 지원 (NTFS, EXT)


- 마운트
  - 유닉스, 리눅스 에서 많이 쓰는 표현
  - 한 저장 장치의 파일 시스템에서 다른 저장 장치의 파일 시스템에 접근할 수 있도록 파일시스템을 편입시키는 작업
  - 다양한 저장장치를 컴퓨터에 연결할때 mount 명령어로 주로 연결